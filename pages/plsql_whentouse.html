<!--{
    "Title": "Когда использовать PL/SQL",
    "Links": {
        "Next": {
            "Url": "../plsql_anonymous_blocks/index.html",
            "Title": "Анонимные блоки"
        },
        "Prev": {
            "Url": "../plsql_intro/index.html",
            "Title": "Что такое PL/SQL"
        }
        }
}-->

<div class="doc-head mb-4 container-10">
    <h5 class="heading-micro heading-muted">Введение</h5>
    <h1 class="heading-huge heading-heavy">Когда использовать PL/SQL </h1>
</div>

<div class="doc-toc mt-6 mb-6">
    <nav class="menu menu-underline menu-medium menu-numbered">
        <ul class="menu-list">
        <li class="menu-item"><a href="#incapsulation" class="menu-link"> Инкапсуляция </a></li>
        <li class="menu-item"><a href="#sqlnotenough" class="menu-link"> Недостаточно возможностей SQL </a></li>
        <li class="menu-item"><a href="#maintainability" class="menu-link"> Сопровождаемость </a></li>
        </ul>
    </nav>
</div>


<p>
PL/SQL нужно использовать, когда:
<ul>
<li> Нужно скрыть функционал за общим интерфейсом(инкапсуляция) </li>
<li> Возможностей SQL недостаточно </li>
<li> Реализация на PL/SQL будет более сопровождаемой </li>
</ul>
</p>

<p>
Коротко по каждому из пунктов.
</p>

<h2 id="incapsulation">Инкапсуляция</h2>

<p>
Мы можем создать функцию, либо хранимую процедуру, после чего
различные клиенты смогут воспользоваться ими, не зная деталей
реализации функционала.
</p>

<h2 id="sqlnotenough">Недостаточно возможностей SQL</h2>

<p>
Здесь лучше подойтет пример. Предположим, нам нужно
реализовать логику:

<ol>
<li>Если значение некоего параметра, назовем его `quantity`,
больше 100, то:</li>
<li>Удалить некоторые строки из таблицы A.</li>
<li>Иначе:</li>
<li>Изменить некоторые строки в таблице B</li>
</ol>
</p>

<p>
Пункты 2 и 3 легко реализуются на чистом SQL. Связки
1-2 и 3-4 также можно реализовать на SQL, но условное
выполнение 2 либо 4 возможно только при добавлении
возможностей ветвления PL/SQL.
</p>

<h2 id="maintainability">Сопровождаемость</h2>

<p>
В один монстрообразный SQL-запрос можно засунуть много
сложной логики, и в целом так и нужно поступать, но
лишь до тех пор, пока ты уверен, что он:

<ul>
<li>Понятен</li>
<li>Будет понятен через полгода</li>
<li>Тестируем</li>
</ul>
</p>

<p>
Если есть сомнения, лучше разделить функционал на более
простые части(используя хранимые процедуры, например)
и реализовать каждую из них отдельно.
</p>