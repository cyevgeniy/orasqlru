<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/design.css><link rel=stylesheet href=/css/layout.css><link rel=stylesheet href=/css/base.css><link rel=stylesheet href=/css/navigation.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-144211477-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-144211477-1")</script><title>Учебник Oracle SQL, PL/SQL | Функции для работы с NULL</title></head><body><div class=menu><a href=/ class=menu__item>Orasql.ru</a>
<a href=/#sql class=menu__item>Учебник Oracle SQL</a>
<a href=/#plsql class=menu__item>Учебник PL/SQL</a></div><div class=content><h1>Функции для работы с NULL</h1><p>Так как <code>NULL</code> - особое значение, то он удостоился отдельных функций в
Oracle, которые умеют работать с ним &ldquo;из коробки&rdquo;.</p><h2 id=подготовка-тестовых-данных>Подготовка тестовых данных</h2><p>Работать будем со следующей таблицей:</p><pre><code>create table profiles(
    login varchar2(30) primary key,
    last_updated date,
    status varchar2(50)
);

comment on table profiles is 'Профили форума';
comment on column profiles.last_updated is 'Дата последнего обновления';
comment on column profiles.status is 'Статус';

insert into profiles(login, last_updated, status)
values ('johndoe', to_date('01.01.2009 23:40', 'dd.mm.yyyy hh24:mi'), '');

insert into profiles(login, last_updated, status)
values ('admin', to_date('01.01.2019 21:03', 'dd.mm.yyyy hh24:mi'), 'Я админ. Все вопросы ко мне');

insert into profiles(login, last_updated, status)
values ('alisa', null, 'Окажу помощь в проектировании домов');

insert into profiles(login, last_updated, status)
values ('nelsol', null, null);
</code></pre><h2 id=nvl>Nvl</h2><pre><code>select nvl(2, 10) nvl_1,
    nvl(null, 20) nvl_2
from dual
</code></pre><p>Данная функция принимает 2 параметра. Если первый параметр равен <code>NULL</code>,
то будет возвращен второй параметр. В противном случае функция вернет
первый параметр.</p><pre><code>select pf.login,
    pf.last_updated,
    nvl(pf.status, '') status
from profiles pf
</code></pre><p><img src=/img/4_1_nulls/nvl.png alt></p><p>Здесь мы получаем данные из таблицы профилей, и в том случае, если
статус пуст, выводим строку &ldquo;&rdquo;.</p><h2 id=nvl2>Nvl2</h2><p>Функция <code>nvl2</code> работает немного сложнее. Она принимает 3 параметра. В
том случае, если первый параметр не <code>NULL</code>, она вернет второй параметр.
В противном случае она вернет третий параметр:</p><pre><code>select pf.login,
    pf.last_updated,
    nvl2(pf.status, 'статус указан', 'статус не указан') status
from profiles pf
</code></pre><p><img src=/img/4_1_nulls/nvl2.png alt></p><h2 id=coalesce>Coalesce</h2><p>Данная функция принимает на вход любое количество параметров и
возвращает первое, из них, которое не является <code>NULL</code>:</p><pre><code>select login,
       coalesce(status, 'статус пуст') first_not_null,
       coalesce(status, null, null, 'статус пуст') first_not_null_1,
       coalesce('статус всегда заполнен', status) first_not_null_2
from profiles
</code></pre><p><img src=/img/4_1_nulls/coalesce.png alt></p><p>В том случае, если в функцию <code>COALESCE</code> передаются параметры разных
типов, то все параметры будут приведены к типу первого <code>NOT NULL</code>
аргумента.</p><p>В том случае, если этого сделать не получится, будет выброшена ошибка:</p><pre><code>select coalesce(null, 'String', 'String_2') not_null_str
from dual
</code></pre><p><img src=/img/4_1_nulls/coalesce_1.png alt></p><pre><code>select coalesce(null, 'String', 23.4) not_null_str
from dual
</code></pre><p><img src=/img/4_1_nulls/coalesce_error.png alt></p><p>При этом, если число привести к строке самим, все будет работать, как
ожидается:</p><pre><code>select coalesce(null, 'String', to_char(23.4)) not_null_str
from dual
</code></pre><p><img src=/img/4_1_nulls/coalesce_1.png alt></p></div><footer class="footer b-dark-low b-top"><div class="footer-container container centered edges"><p class="text-medium text-moderated">© Orasql.ru<br>2019-2023</p></div></div></footer></body></html>